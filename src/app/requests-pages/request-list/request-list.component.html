<div class="container-fluid">
  <div class="navbarx main-container">
    <nav class="navbar navbar-light bg-light">
      <a class="navbar-brand">
        <img src="assets/img/EpsoftLogo.png" class="image-align" alt="Epsoft" />
        <span><b class="heading">Request Environment Management</b></span>
      </a>

      <button class="btn btn-success esport" (click)="raiseRequest()" type="button">
        Raise Request
      </button>
    </nav>
  </div>

  <div class="d-flex search">
    <input
      class="form-control me-2"
      type="search"
      placeholder="Search"
      aria-label="Search"
      [(ngModel)]="term"
    />

    <button
      class="btn btn-outline-primary export"
      type="submit"
      (click)="exportToExcel()"
    >
      Export to Excel
    </button>

    <span>
      <input
        type="date"
        name="deployTime"
        aria-label="Search"
        [(ngModel)]="term"
        placeholder="none"
      />
    </span>
  </div>

  <div id="excel-table" class="table1">
    <table class="table table-hover table">
      <thead>
        <tr class="table style" style="font-family: Roboto; font-size: 18px;">
          <th scope="col">Purpose</th>
          <th scope="col">Request Type</th>
          <th scope="col">Environment</th>
          <th scope="col">Artifact</th>
          <th scope="col">RequestUser</th>
          <th scope="col">ApprovedUser</th>
          <th scope="col">Deploydate</th>
          <th scope="col">RequestedTime</th>
          <th scope="col">Comments</th>
        </tr>
      </thead>
      <tbody>
        <tr
          *ngFor="let Request of AllRequests | filter: term | paginate: {itemsPerPage:9 , currentPage:p} "
        >
          <td>{{Request.purposeOfReq}}</td>
          <td>{{Request.typeOfReq}}</td>
          <td>{{Request.environment}}</td>
          <td>{{Request.artifact}}</td>
          <td>{{Request.requestUser}}</td>
          <td>{{Request.approvedUser}}</td>
          <td>{{Request.deployTime}}</td>
          <td>{{Request.ReqCreatedTime}}</td>
          <td>{{Request.comment}}</td>
        </tr>
      </tbody>
    </table>
  </div>
  <div class="pagenation">
    <pagination-controls (pageChange)="p = $event"></pagination-controls>
  </div>
</div>
